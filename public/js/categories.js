import{i as e}from"./chunks/navigation-BNxy9xC7.js";import{i as t}from"./chunks/profile-BfLkpaKJ.js";import{A as n}from"./chunks/api-BDCGX8nm.js";import{t as a,a as c}from"./chunks/Toast-Cw3r9-oW.js";import{c as o}from"./chunks/ModalBase-nBdty8ot.js";async function r(){try{const e=await n.categories.getAll(),t=document.querySelector("#categoriesTable tbody");if(!t)return;if(t.innerHTML="",!e.length){const e=document.createElement("tr"),n=document.createElement("td");return n.colSpan=3,n.textContent="Категорий пока нет",e.appendChild(n),void t.appendChild(e)}e.forEach(e=>{const d=document.createElement("tr"),s=document.createElement("td");s.textContent=e.name;const i=document.createElement("td");i.textContent="income"===e.kind?"Доход":"Расход";const m=document.createElement("td"),l=document.createElement("button");l.textContent="Удалить",l.className="btn-primary",l.style.background="var(--danger)",l.style.fontSize="0.8rem",l.addEventListener("click",async()=>{if(await o({title:"Удалить категорию?",message:"Все операции останутся без категории.",confirmText:"Удалить",danger:!0}))try{await n.categories.delete(e.id),a("Категория удалена"),r()}catch(t){c(`Не удалось удалить: ${t.message}`)}}),m.appendChild(l),d.append(s,i,m),t.appendChild(d)})}catch(e){}}async function d(){r();const e=document.getElementById("addCategoryForm");e&&e.addEventListener("submit",async t=>{t.preventDefault();const o=document.getElementById("catName").value.trim(),d=document.getElementById("catKind").value;if(o)try{await n.categories.create({name:o,kind:d}),a("Категория добавлена!"),r(),e.reset()}catch(s){c(`Не удалось добавить: ${s.message}`)}})}e(),t(),"loading"!==document.readyState?d():document.addEventListener("DOMContentLoaded",d);
