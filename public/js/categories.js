import{i as l,p as u,f as p,d as g}from"./profile-DStBtrFs.js";import{i as f}from"./navigation-BDLIzq93.js";f();l();async function c(){try{const t=await p("/api/categories"),a=document.querySelector("#categoriesTable tbody");if(!a)return;if(a.innerHTML="",!t.length){const e=document.createElement("tr"),n=document.createElement("td");n.colSpan=3,n.textContent="Категории пока не созданы",e.appendChild(n),a.appendChild(e);return}t.forEach(e=>{const n=document.createElement("tr"),r=document.createElement("td");r.textContent=e.name;const d=document.createElement("td");d.textContent=e.kind==="income"?"Доход":"Расход";const i=document.createElement("td"),o=document.createElement("button");o.textContent="Удалить",o.className="btn-primary",o.style.background="var(--danger)",o.style.fontSize="0.8rem",o.addEventListener("click",async()=>{if(confirm("Удалить категорию? Связанные транзакции останутся без категории."))try{await g(`/api/categories/${e.id}`),c()}catch(m){alert(m.message||"Не удалось удалить категорию")}}),i.appendChild(o),n.append(r,d,i),a.appendChild(n)})}catch(t){console.error(t)}}async function s(){c();const t=document.getElementById("addCategoryForm");t&&t.addEventListener("submit",async a=>{a.preventDefault();const e=document.getElementById("catName").value.trim(),n=document.getElementById("catKind").value;if(e)try{await u("/api/categories",{name:e,kind:n}),t.reset(),c()}catch(r){alert(r.message||"Не удалось создать категорию")}})}document.readyState!=="loading"?s():document.addEventListener("DOMContentLoaded",s);
