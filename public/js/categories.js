import{f as u}from"./api-D6s1A7e-.js";import{i as f}from"./navigation-BDLIzq93.js";import{i as p}from"./profile-BEROGLl0.js";f();p();async function d(){try{const t=await u("/api/categories"),r=document.querySelector("#categoriesTable tbody");if(!r)return;if(r.innerHTML="",!t.length){const e=document.createElement("tr"),n=document.createElement("td");n.colSpan=3,n.textContent="Категорий пока нет",e.appendChild(n),r.appendChild(e);return}t.forEach(e=>{const n=document.createElement("tr"),o=document.createElement("td");o.textContent=e.name;const c=document.createElement("td");c.textContent=e.kind==="income"?"Доход":"Расход";const s=document.createElement("td"),a=document.createElement("button");a.textContent="Удалить",a.className="btn-primary",a.style.background="var(--danger)",a.style.fontSize="0.8rem",a.addEventListener("click",async()=>{if(confirm("Удалить категорию? Все операции останутся без категории."))try{const i=await fetch(`/api/categories/${e.id}`,{method:"DELETE"});if(i.ok)d();else{const l=await i.json();alert("Ошибка: "+(l.error||"не удалось удалить"))}}catch(i){console.error(i),alert("Ошибка сети")}}),s.appendChild(a),n.append(o,c,s),r.appendChild(n)})}catch(t){console.error(t)}}async function m(){d();const t=document.getElementById("addCategoryForm");t&&t.addEventListener("submit",async r=>{r.preventDefault();const e=document.getElementById("catName").value.trim(),n=document.getElementById("catKind").value;if(e)try{const o=await fetch("/api/categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,kind:n})});if(o.ok){const c=await o.json();d(),t.reset()}else{const c=await o.json();alert("Ошибка: "+(c.error||"не удалось добавить"))}}catch(o){console.error(o),alert("Ошибка сети")}})}document.readyState!=="loading"?m():document.addEventListener("DOMContentLoaded",m);
