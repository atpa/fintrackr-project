import{i as e}from"./chunks/navigation-BNxy9xC7.js";import{i as t}from"./chunks/profile-BfLkpaKJ.js";import{A as n}from"./chunks/api-BDCGX8nm.js";import{t as a,a as o}from"./chunks/Toast-Cw3r9-oW.js";function d(e,t){if(t.innerHTML="",!e.length){const e=document.createElement("p");return e.textContent="Цели отсутствуют",void t.appendChild(e)}e.forEach(e=>{const n=document.createElement("div");n.className="goal-card";const a=document.createElement("h3");a.textContent=e.title;const o=document.createElement("p"),d=Number(e.current_amount||0),c=Number(e.target_amount);o.innerHTML=`<strong>${d.toFixed(2)}</strong> / ${c.toFixed(2)}`;const s=document.createElement("div");s.className="progress-bar-small";const l=document.createElement("div"),m=c>0?Math.min(d/c*100,100):0;l.style.width=m.toFixed(0)+"%",s.appendChild(l);const r=document.createElement("p");r.className="deadline",r.textContent=e.deadline?`Дедлайн: ${e.deadline}`:"Без дедлайна",n.append(a,o,s,r),t.appendChild(n)})}async function c(){const e=document.getElementById("goalsGrid");if(e)try{let t=await n.goals.getAll();d(t,e);const c=document.getElementById("addGoalForm");c&&c.addEventListener("submit",async s=>{s.preventDefault();const l={title:document.getElementById("goalTitle").value,target_amount:parseFloat(document.getElementById("goalTarget").value),current_amount:parseFloat(document.getElementById("goalCurrent").value)||0,deadline:document.getElementById("goalDeadline").value};try{const o=await n.goals.create(l);t.push(o),a("Цель добавлена!"),d(t,e),c.reset()}catch(m){o(`Не удалось добавить цель: ${m.message}`)}})}catch(t){o(`Не удалось загрузить цели: ${t.message}`)}}e(),t(),"loading"!==document.readyState?c():document.addEventListener("DOMContentLoaded",c);
