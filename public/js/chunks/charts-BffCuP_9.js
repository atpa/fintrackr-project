import{f as t}from"../cardAccount.js";function e(e,a,n="USD"){const r=e.reduce((t,e)=>{const a=e.category_id;return t[a]||(t[a]=0),t[a]+=Math.abs(Number(e.amount)),t},{}),o=Object.entries(r).sort(([,t],[,e])=>e-t).slice(0,5);return{type:"doughnut",data:{labels:o.map(([t])=>{const e=a.find(e=>e.id===t);return e?`${e.icon||""} ${e.name}`.trim():"Без категории"}),datasets:[{data:o.map(([,t])=>t),backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF"],hoverOffset:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"},tooltip:{callbacks:{label:e=>{const a=e.parsed;return`${e.label}: ${t(a,n)}`}}}}}}}function a(e,a="USD",n=6){const r=new Date,o=[],s=[],l=[];for(let t=n-1;t>=0;t--){const a=new Date(r.getFullYear(),r.getMonth()-t,1),n=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`;o.push(a.toLocaleDateString("ru-RU",{month:"short",year:"numeric"}));const c=e.filter(t=>{var e;return null==(e=t.date)?void 0:e.startsWith(n)}),i=c.filter(t=>"income"===t.type).reduce((t,e)=>t+Math.abs(Number(e.amount)),0),u=c.filter(t=>"expense"===t.type).reduce((t,e)=>t+Math.abs(Number(e.amount)),0);s.push(i),l.push(u)}return{type:"bar",data:{labels:o,datasets:[{label:"Доходы",data:s,backgroundColor:"#28a745",borderRadius:4},{label:"Расходы",data:l,backgroundColor:"#dc3545",borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{callback:e=>t(e,a)}}},plugins:{legend:{position:"top"},tooltip:{callbacks:{label:e=>`${e.dataset.label}: ${t(e.parsed.y,a)}`}}}}}}function n(t,e){const a=document.getElementById(t);return a?(a._chartInstance&&a._chartInstance.destroy(),"undefined"==typeof Chart?null:(a._chartInstance=new Chart(a.getContext("2d"),e),a._chartInstance)):null}export{a,e as c,n as r};
