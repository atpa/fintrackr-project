let e=[],t=0;function n(n){const{title:o="",content:a="",size:l="md",actions:d=[],closeOnBackdrop:c=!0,closeOnEsc:s=!0,showCloseButton:i=!0,onOpen:r=null,onClose:m=null}=n,u="modal-"+ ++t,v=1e3+10*e.length,p=document.createElement("div");p.className="modal-backdrop",p.style.zIndex=v,p.setAttribute("aria-hidden","true");const b=document.createElement("div");b.className="modal-container",b.style.zIndex=v+1;const h=document.createElement("div");h.className=`modal modal--${l}`,h.id=u,h.setAttribute("role","dialog"),h.setAttribute("aria-modal","true"),o&&h.setAttribute("aria-labelledby",`${u}-title`);const y=document.createElement("div");y.className="modal-header",y.innerHTML=`\n    <h2 class="modal-title" id="${u}-title">${o}</h2>\n    ${i?'<button class="modal-close" aria-label="Закрыть"><svg viewBox="0 0 24 24" width="24" height="24"><path d="M6 18L18 6M6 6l12 12" stroke="currentColor" stroke-width="2"/></svg></button>':""}\n  `;const k=document.createElement("div");k.className="modal-body","string"==typeof a?k.innerHTML=a:k.appendChild(a);const f=document.createElement("div");d.length>0&&(f.className="modal-footer",d.forEach(e=>{const t=document.createElement("button");t.className=`btn btn--${e.variant||"secondary"}`,t.textContent=e.label,t.addEventListener("click",()=>{e.onClick&&e.onClick(E)}),f.appendChild(t)})),h.appendChild(y),h.appendChild(k),d.length>0&&h.appendChild(f),b.appendChild(h),document.body.appendChild(p),document.body.appendChild(b),document.body.style.overflow="hidden",requestAnimationFrame(()=>{p.classList.add("modal-backdrop--active"),b.classList.add("modal-container--active")});const E=()=>{p.classList.remove("modal-backdrop--active"),b.classList.remove("modal-container--active"),setTimeout(()=>{p.remove(),b.remove(),e=e.filter(e=>e.id!==u),0===e.length&&(document.body.style.overflow=""),m&&m()},300)};if(i){h.querySelector(".modal-close").addEventListener("click",E)}if(c&&p.addEventListener("click",E),s){const t=n=>{var o;"Escape"===n.key&&(null==(o=e[e.length-1])?void 0:o.id)===u&&(E(),document.removeEventListener("keydown",t))};document.addEventListener("keydown",t)}const C=h.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),L=C[0],g=C[C.length-1];h.addEventListener("keydown",e=>{"Tab"===e.key&&(e.shiftKey?document.activeElement===L&&(g.focus(),e.preventDefault()):document.activeElement===g&&(L.focus(),e.preventDefault()))}),setTimeout(()=>{L&&L.focus()},100);const w={id:u,close:E,modal:h,modalBody:k};return e.push(w),r&&r(w),w}function o(e={}){return new Promise(t=>{const{title:o="Подтверждение",message:a="Вы уверены?",confirmLabel:l="Подтвердить",cancelLabel:d="Отмена",danger:c=!1}=e;n({title:o,content:`<p>${a}</p>`,size:"sm",actions:[{label:d,variant:"secondary",onClick:e=>{t(!1),e()}},{label:l,variant:c?"danger":"primary",onClick:e=>{t(!0),e()}}],closeOnBackdrop:!1,onClose:()=>t(!1)})})}export{o as c,n as o};
