<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FinTrackr – Дэшборд</title>
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/layout-components.css" />
  </head>
  <body>
    <!-- Layout инициализируется через JS -->
    <div id="app-root">
      <main class="workspace-main" id="main-content">
      <section class="alert-banner alert-banner--info" aria-live="polite">
        <div>
          <p class="alert-banner-title">AI ассистент</p>
          <p class="alert-banner-text">Последние операции синхронизированы. Добавьте бюджет, чтобы получать прогноз экономии.</p>
        </div>
        <button class="btn-secondary btn-pill" onclick="location.href='budgets.html'">Создать бюджет</button>
      </section>

      <section class="stats-grid">
        <article class="stat-card stat-card--balance">
          <div class="stat-card-label">Баланс</div>
          <div class="stat-card-value">
            <strong id="totalBalance">0.00</strong>
            <span class="currency-code">USD</span>
          </div>
          <p class="stat-card-note">Консолидировано по всем счетам</p>
        </article>
        <article class="stat-card stat-card--income">
          <div class="stat-card-label">Сумма доходов</div>
          <div class="stat-card-value">
            <strong id="totalIncome">0.00</strong>
            <span class="currency-code">USD</span>
          </div>
          <p class="stat-card-note">Обновлено сегодня</p>
        </article>
        <article class="stat-card stat-card--expense">
          <div class="stat-card-label">Сумма расходов</div>
          <div class="stat-card-value">
            <strong id="totalExpense">0.00</strong>
            <span class="currency-code">USD</span>
          </div>
          <p class="stat-card-note">Включая регулярные платежи</p>
        </article>
        <article class="stat-card stat-card--neutral">
          <div class="stat-card-label">Финансовое здоровье</div>
          <div class="stat-card-value">
            <strong id="financialHealth">0%</strong>
          </div>
          <div class="progress-bar">
            <div id="healthProgress" class="progress" style="width:0%"></div>
          </div>
        </article>
      </section>

      <section class="panel-grid">
        <article class="card card--wide">
          <div class="card-header">
            <div>
              <h2>Расходы по категориям</h2>
              <p class="card-subtitle">Текущий месяц, обновление ежедневно</p>
            </div>
            <button class="btn-secondary btn-pill">Экспорт</button>
          </div>
          <div class="chart-container">
            <canvas
              id="expenseChart"
              width="600"
              height="300"
              aria-label="График расходов"
              role="img"
            ></canvas>
          </div>
        </article>

        <article class="card card--wide">
          <div class="card-header">
            <div>
              <h2>Структура расходов</h2>
              <p class="card-subtitle">Узнайте, какие категории тянут бюджет вниз</p>
            </div>
            <a class="link-ghost" href="categories.html">Управлять категориями →</a>
          </div>
          <div class="chart-container chart-container--split">
            <canvas
              id="expensePie"
              width="300"
              height="300"
              aria-label="Круговая диаграмма расходов"
              role="img"
            ></canvas>
            <div class="top-list">
              <h3>Топ расходов</h3>
              <ul id="topCategories" class="list-compact">
                <li>Нет данных</li>
              </ul>
            </div>
          </div>
        </article>
      </section>

      <section class="panel-grid">
        <article class="card card--wide">
          <div class="card-header">
            <div>
              <h2>Cashflow (последние 6 месяцев)</h2>
              <p class="card-subtitle">Динамика доходов и расходов</p>
            </div>
            <button class="btn-secondary btn-pill">Детали →</button>
          </div>
          <div class="chart-container">
            <canvas
              id="cashflowChart"
              width="600"
              height="300"
              aria-label="График cashflow"
              role="img"
            ></canvas>
          </div>
        </article>
      </section>

      <section class="insight-grid">
        <article class="card">
          <div class="card-header">
            <div>
              <h2>AI-прогноз (30 дней)</h2>
              <p class="card-subtitle">Ключевые показатели в валюте баланса</p>
            </div>
            <span class="pill pill--accent">Beta</span>
          </div>
          <div class="ai-grid">
            <div>
              <p class="muted-label">Доход</p>
              <p class="ai-value">
                <strong id="aiIncome">0.00</strong>
                <span class="currency-code">USD</span>
              </p>
            </div>
            <div>
              <p class="muted-label">Расход</p>
              <p class="ai-value">
                <strong id="aiExpense">0.00</strong>
                <span class="currency-code">USD</span>
              </p>
            </div>
          </div>
          <p class="card-note">Алгоритм анализирует тренды операций и уведомит, если траты выходят за рамки бюджета.</p>
        </article>

        <article class="card">
          <div class="card-header">
            <div>
              <h2>Напоминания</h2>
              <p class="card-subtitle">Подключите банковские связи, чтобы получать больше инсайтов</p>
            </div>
          </div>
          <ul class="list-reminders">
            <li>
              <span class="pill pill--warning">Счета</span>
              <div>
                <p class="reminder-title">Добавьте хотя бы один бюджет</p>
                <p class="reminder-meta">Это поможет AI точнее прогнозировать траты.</p>
              </div>
              <button class="link-ghost" onclick="location.href='budgets.html'">Открыть</button>
            </li>
            <li>
              <span class="pill pill--neutral">Цели</span>
              <div>
                <p class="reminder-title">Назначьте цель накоплений</p>
                <p class="reminder-meta">Следите за прогрессом прямо в дэшборде.</p>
              </div>
              <button class="link-ghost" onclick="location.href='goals.html'">Создать</button>
            </li>
          </ul>
        </article>
      </section>
      </main>
    </div>

    <footer>
      <p>&copy; 2025 FinTrackr. Все права защищены.</p>
    </footer>

    <!-- New Architecture: ES6 Modules -->
    <script type="module">
      import { initLayout } from './js/layout.js';
      
      // Инициализация Layout с Header + Sidebar
      document.addEventListener('DOMContentLoaded', async () => {
        const layout = await initLayout({
          contentId: 'main-content',
          showHeader: true,
          showSidebar: true,
          onReady: () => {
            console.log('✅ Dashboard layout готов');
            // TODO: загрузить данные для dashboard
          }
        });
      });
    </script>
  </body>
</html>
