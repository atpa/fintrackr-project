<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <meta name="description" content="FinTrackr - современное приложение для управления личными финансами" />
    <meta name="theme-color" content="#6366f1" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="FinTrackr" />
    <title>FinTrackr – Дэшборд</title>
    <link rel="stylesheet" href="css/tokens.css" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/design-system.css" />
    <link rel="stylesheet" href="css/sidebar-footer.css" />
    <link rel="stylesheet" href="css/icons.css" />
    <link rel="stylesheet" href="css/transitions.css" />
    <link rel="manifest" href="/manifest.json" />
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png" />
  <script defer src="js/utils/auth.js"></script>
  <script defer src="js/app.js"></script>
  
  <!-- Sidebar Component Initialization -->
  <script type="module">
    import { mountSidebar } from '/js/components/Sidebar.js';
    
    // Mount sidebar после загрузки DOM
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => mountSidebar('sidebar-mount'));
    } else {
      mountSidebar('sidebar-mount');
    }
  </script>
  </head>
  <body class="workspace-page" data-page-title="Дэшборд" data-page-subtitle="Прогнозы, бюджеты и уведомления в едином месте">
    <a href="#main-content" class="visually-hidden" tabindex="1">Перейти к основному содержимому</a>
    
    <header role="banner">
      <div class="header-inner">
        <div class="header-left">
          <button class="burger" aria-label="Открыть меню навигации" aria-expanded="false" aria-controls="sidebar">
            <span></span><span></span><span></span>
          </button>
          <div class="logo-text">FinTrackr</div>
        </div>

        <div class="header-center">
          <div class="header-search">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
              <path d="M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16zM18 18l-4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <input type="search" placeholder="Поиск операций, счетов..." aria-label="Поиск" />
          </div>
          
          <select class="currency-selector" aria-label="Выбор валюты">
            <option value="USD">USD</option>
            <option value="EUR">EUR</option>
            <option value="RUB">RUB</option>
            <option value="PLN">PLN</option>
          </select>
        </div>

        <div class="header-right">
          <button class="btn-primary" onclick="location.href='transactions.html'">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
              <path d="M10 5v10M5 10h10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            Операция
          </button>
          
          <div class="header-quick">
            <button class="icon-btn" aria-label="Уведомления">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/>
              </svg>
            </button>
            
            <button class="icon-btn" aria-label="Профиль" onclick="location.href='settings.html'">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Sidebar Component Mount Point -->
    <div id="sidebar-mount"></div>

    <main class="workspace-main" id="main-content" role="main">
      <section class="alert-banner alert-banner--info" aria-live="polite">
        <div>
          <p class="alert-banner-title">AI ассистент</p>
          <p class="alert-banner-text">Последние операции синхронизированы. Добавьте бюджет, чтобы получать прогноз экономии.</p>
        </div>
        <button class="btn-secondary btn-pill" onclick="location.href='budgets.html'">Создать бюджет</button>
      </section>

      <section class="stats-grid">
        <article class="stat-card stat-card--balance">
          <div class="stat-card-label">Баланс</div>
          <div class="stat-card-value">
            <strong id="totalBalance">0.00</strong>
            <span class="currency-code">USD</span>
          </div>
          <p class="stat-card-note">Консолидировано по всем счетам</p>
        </article>
        <article class="stat-card stat-card--income">
          <div class="stat-card-label">Сумма доходов</div>
          <div class="stat-card-value">
            <strong id="totalIncome">0.00</strong>
            <span class="currency-code">USD</span>
          </div>
          <p class="stat-card-note">Обновлено сегодня</p>
        </article>
        <article class="stat-card stat-card--expense">
          <div class="stat-card-label">Сумма расходов</div>
          <div class="stat-card-value">
            <strong id="totalExpense">0.00</strong>
            <span class="currency-code">USD</span>
          </div>
          <p class="stat-card-note">Включая регулярные платежи</p>
        </article>
        <article class="stat-card stat-card--neutral">
          <div class="stat-card-label">Финансовое здоровье</div>
          <div class="stat-card-value">
            <strong id="financialHealth">0%</strong>
          </div>
          <div class="progress-bar">
            <div id="healthProgress" class="progress" style="width:0%"></div>
          </div>
        </article>
      </section>

      <section class="panel-grid">
        <article class="card card--wide">
          <div class="card-header">
            <div>
              <h2>Расходы по категориям</h2>
              <p class="card-subtitle">Текущий месяц, обновление ежедневно</p>
            </div>
            <button class="btn-secondary btn-pill">Экспорт</button>
          </div>
          <div class="chart-container">
            <canvas
              id="expenseChart"
              width="600"
              height="300"
              aria-label="График расходов"
              role="img"
            ></canvas>
          </div>
        </article>

        <article class="card card--wide">
          <div class="card-header">
            <div>
              <h2>Структура расходов</h2>
              <p class="card-subtitle">Узнайте, какие категории тянут бюджет вниз</p>
            </div>
            <a class="link-ghost" href="categories.html">Управлять категориями →</a>
          </div>
          <div class="chart-container chart-container--split">
            <canvas
              id="expensePie"
              width="300"
              height="300"
              aria-label="Круговая диаграмма расходов"
              role="img"
            ></canvas>
            <div class="top-list">
              <h3>Топ расходов</h3>
              <ul id="topCategories" class="list-compact">
                <li>Нет данных</li>
              </ul>
            </div>
          </div>
        </article>
      </section>

      <section class="insight-grid">
        <article class="card">
          <div class="card-header">
            <div>
              <h2>AI-прогноз (30 дней)</h2>
              <p class="card-subtitle">Ключевые показатели в валюте баланса</p>
            </div>
            <span class="pill pill--accent">Beta</span>
          </div>
          <div class="ai-grid">
            <div>
              <p class="muted-label">Доход</p>
              <p class="ai-value">
                <strong id="aiIncome">0.00</strong>
                <span class="currency-code">USD</span>
              </p>
            </div>
            <div>
              <p class="muted-label">Расход</p>
              <p class="ai-value">
                <strong id="aiExpense">0.00</strong>
                <span class="currency-code">USD</span>
              </p>
            </div>
          </div>
          <p class="card-note">Алгоритм анализирует тренды операций и уведомит, если траты выходят за рамки бюджета.</p>
        </article>

        <article class="card">
          <div class="card-header">
            <div>
              <h2>Напоминания</h2>
              <p class="card-subtitle">Подключите банковские связи, чтобы получать больше инсайтов</p>
            </div>
          </div>
          <ul class="list-reminders">
            <li>
              <span class="pill pill--warning">Счета</span>
              <div>
                <p class="reminder-title">Добавьте хотя бы один бюджет</p>
                <p class="reminder-meta">Это поможет AI точнее прогнозировать траты.</p>
              </div>
              <button class="link-ghost" onclick="location.href='budgets.html'">Открыть</button>
            </li>
            <li>
              <span class="pill pill--neutral">Цели</span>
              <div>
                <p class="reminder-title">Назначьте цель накоплений</p>
                <p class="reminder-meta">Следите за прогрессом прямо в дэшборде.</p>
              </div>
              <button class="link-ghost" onclick="location.href='goals.html'">Создать</button>
            </li>
          </ul>
        </article>
      </section>
    </main>

    <footer>
      <p>&copy; 2025 FinTrackr. Все права защищены.</p>
    </footer>
  </body>
</html>
